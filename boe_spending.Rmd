```{r}
library(tidyverse)
library(janitor)
```

```{r}
boe_spending <- read_csv("~/code/boe_spending/County_Board_of_Education_-_Spending_Disclosures.csv") %>% clean_names() %>% mutate(agency_name = str_to_upper(agency_name), payee_name_clean = str_to_upper(payee_name), payee_zip5 = str_sub(payee_zip, 1, 5))
```

### General cleaning

```{r}
boe_spending <- boe_spending %>% 
  mutate(payee_name_clean = str_squish(payee_name_clean)) %>% 
  mutate(payee_name_clean = str_replace(payee_name_clean, ",", "")) %>%
  mutate(payee_name_clean = str_replace(payee_name_clean, "[.]", "")) %>%
  mutate(payee_name_clean = str_replace(payee_name_clean, "INC.", "INC")) %>%
  mutate(agency_name = str_replace(agency_name, "ST.", "ST"))
```


### County-specific cleaning
```{r}
# Howard
boe_spending <- boe_spending %>% 
  mutate(payee_name_clean = str_replace(payee_name_clean, '(EFT)','')) %>% mutate(payee_name_clean = str_replace(payee_name_clean, ' (EFTPS ONLY)',''))

# Prince George's
boe_spending <- boe_spending %>% 
  mutate(agency_name = case_when(
      agency_name == "PRINCE GEORGES' COUNTY PUBLIC SCHOOLS" ~ "PRINCE GEORGE'S COUNTY PUBLIC SCHOOLS",
      TRUE ~ agency_name
  ))
```


### Generate unique payee_name_clean

```{r}
unique_payee_name_clean <- boe_spending %>% 
  group_by(payee_name_clean) %>% 
  summarize(count = n())


write_csv(unique_payee_name_clean, "unique_payee_name_clean.csv")
```

